<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Gitea on Ehlxr's Blog</title><link>https://3w.vercel.app/tags/Gitea/</link><description>Recent content in Gitea on Ehlxr's Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><lastBuildDate>Wed, 06 Jan 2021 14:01:50 +0800</lastBuildDate><atom:link href="https://3w.vercel.app/tags/Gitea/rss.xml" rel="self" type="application/rss+xml"/><item><title>Docker 安装 Gitea/Gogs 与主机共享 22 端口</title><link>https://3w.vercel.app/2021/01/06/docker-gitea-share-port-22-with-host/</link><pubDate>Wed, 06 Jan 2021 14:01:50 +0800</pubDate><guid>https://3w.vercel.app/2021/01/06/docker-gitea-share-port-22-with-host/</guid><description>&lt;p>如果主机的 22 端口已被使用，使用 &lt;code>Docker&lt;/code> 安装 &lt;code>Gitea&lt;/code> 时只能把容器的 22 端口映射到主机的其它端口（如：10022），这是没有任何问题的。但是以 &lt;code>SSH&lt;/code> 方式 &lt;code>clone&lt;/code> 项目时，&lt;code>URL&lt;/code> 长这样
&lt;code>ssh://git@git.example.com:10022:username/project.git&lt;/code>&lt;/p>
&lt;p>如果我们想要类似以下这样的 &lt;code>URL&lt;/code> 时就需要把 &lt;code>Gitea&lt;/code> 容器的和主机共享 22 端口
&lt;code>git@git.example.com:username/project.git&lt;/code>&lt;/p>
&lt;p>下面总结一下使用 &lt;code>Docker&lt;/code> 安装 &lt;code>Gitea&lt;/code> 共享主机 22 端口的主要步骤，&lt;code>Gogs&lt;/code> 应该是同理。&lt;/p>
&lt;h3 id="创建-git-用户">创建 git 用户&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#60a0b0;font-style:italic"># Create git user&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>adduser git
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#60a0b0;font-style:italic"># Make sure user has UID and GID 1000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>usermod -u &lt;span style="color:#40a070">1000&lt;/span> -g &lt;span style="color:#40a070">1000&lt;/span> git
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#60a0b0;font-style:italic"># Create docker group&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>groupadd docker
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#60a0b0;font-style:italic"># Add git user to docker group&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>usermod -aG docker git
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#60a0b0;font-style:italic"># Create the gitea data directory&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mkdir -p /home/git/gitea/data
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>